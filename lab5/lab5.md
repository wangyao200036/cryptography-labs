
---

<div style="text-align: center; line-height: 1.5;">

**ФЕДЕРАЛЬНОЕ ГОСУДАРСТВЕННОЕ АВТОНОМНОЕ ОБРАЗОВАТЕЛЬНОЕ УЧРЕЖДЕНИЕ
ВЫСШЕГО ОБРАЗОВАНИЯ «РОССИЙСКИЙ УНИВЕРСИТЕТ ДРУЖБЫ НАРОДОВ»**

**Факультет физико-математических и естественных наук**

**Кафедра теории вероятностей и кибербезопасности**

<br>









<br>

**Лабораторная работа № 5**

**Вероятностные алгоритмы проверки чисел на простоту**

<br>
<br>





<br>







| Студент: | Ван Яо |
|----------|------------|
| Группа:  | НФИмд-01-25 |

<br>
<br>
<br>









<br>
<br>
<br>
<br>

**МОСКВА**

**2025 г.**

</div>

<div style="page-break-after: always;"></div>

## Цель работы

1. изучить теоретические основы вероятностных алгоритмов проверки чисел на простоту
2. реализовать программно три вероятностных теста
   - тест ферма
   - тест Соловэя-Шторассена
   - тест Миллера-Рабина
3. провести сравнительный анализ эффективности и точности алгоритмов
## Теоретическая часть

### Определение 
**Простое число** - натуральное число, имеющее ровно два делителя:единицу и само себя
	**Састовное число** - натуральное число, имеющее более двух делителей
	**Вероятностный алгоритм** - алгоритм, использующий генератор случайных чисел и дающий не гарантированно точный ответ
	**Детерминированныц алгоритм** - алгоритм, всегда действующий по одной схеме и гарантированно решающий поставленную задачу

## Алгоритмы реализации

### 1. Тест Ферма

Основна на малой теореме ферма: для простого числа $р$ и произвольного числа $а$, $1 \leq a \leq q-1 $ выполняется сравнение:

$ a^{n-1}\equiv 1 \pmod{p} $

**Алгоритм:**

1. Выбрать случайное целое число $a$,$2 \leq a \leq n-2$
1. вычислить $r\leftarrow a^{n-1} \pmod{n}$
1. Если $r=1$, результат : Число $n$, вероятно, простое, иначе Число $n$ составное

### 2. Тест Соловэя-Шторассена

Основная на Критерии Эйлера и вычислении символов Якоби

**Алгоритм вычислении символов Якоби:**

1. при $a=0$, результат: 0
2. при $a=1$, результат: $g$
3. представить $a$ в виде $a = 2^ka_1$, где $ a_1$ нечетное
4. определить $s$ в зависимости от $k$ и $n\pmod{8} $
5. выполнить рекурсивные вычисления

**Алгоритм:**

1. выбрать случайное целое число $a$,$2\leq a \leq n-2$
1. вычислять $r \leftarrow a^{\frac{n-1}{2}\pmod{n}}$
1. если $r\neq 1$ и $r\neq n-1$, результат: Число составное
1. вычислять символ якобы $s \leftarrow \binom{a}{n}$
1. если $r \not\equiv s\pmod{n}$, результат :число $n$ составное, иначе число $n$, вероятно простое



### 3. Тест Миллера-Рабина



**Алгоритм:**

1. представить $n-1$ в виде $n-1=2^s r$, где $r$ нечетное
1. выбрать случайное целое число $a$,$2\leq a < n-2$
1. вычислять  $y \leftarrow a^r \pmod{n}$
1. если $y\neq 1$ и $y\neq n-1$,выполнить итерации возведения в квадрат 
1. если $y = 1 $, результат :число $n$ составное
1. если после всех итерации $y \neq n-1$,результат :число $n$ составное, иначе число $n$, вероятно простое

## Практическая реализация

### Пример кода

тест ферма

![](https://github.com/wangyao200036/cryptography-labs/raw/main/lab5/pic/1.png)

тест Соловэя-Шторассена

![](https://github.com/wangyao200036/cryptography-labs/raw/main/lab5/pic/2.png)



![](https://github.com/wangyao200036/cryptography-labs/raw/main/lab5/pic/3.png)

тест Миллера-Рабина

![](https://github.com/wangyao200036/cryptography-labs/raw/main/lab5/pic/4.png)


### Функциональное тестирование

| Число для проверки | Ожидаемый результат | Тест Ферма | Тест Соловэя-Штрассена | Тест Миллера-Рабина |
| ------------------ | ------------------- | ---------- | ---------------------- | ------------------- |
| 17                 | простое             | √          | √                      | √                   |
| 25                 | составное           | √          | √                      | √                   |
| 97                 | составное           | √          | √                      | √                   |
| 561                | составное           | ×          | √                      | √                   |
| 1105               | составное           | ×          | √                      | √                   |



## Выводы

1. **Теоретические знания:**  

   ​	Изучены математические основы вероятностных тестов простоты, включая малую теорему Ферма, критерий Эйлера и их применение в криптографии.

2. **Практические навыки:**  

   ​	Реализованы три вероятностных алгоритма проверки чисел на простоту. Тест Ферма показал наличие кармайкловых чисел (например, 561), которые проходят тест, но являются составными.

3. **Аналитические способности:**  

   ​	Тест Миллера-Рабина показал наибольшую надежность среди рассмотренных алгоритмов, правильно идентифицируя кармайкловы числа.

   